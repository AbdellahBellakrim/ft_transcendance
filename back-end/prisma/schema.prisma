<<<<<<< HEAD

=======
>>>>>>> origin/game_dashboard
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


enum Status {
  IN_GAME
  ONLINE
  OFFLINE
}

model User {
  id          String @id @default(uuid())
  username       String @unique
  firstname   String
  lastname   String
  email       String @unique
  avatar      String
  background String
  firstauth   Boolean @default(false)
<<<<<<< HEAD

  status  Status @default(ONLINE)

  match_host  match[] @relation("Player1")
  match_guest match[] @relation("Player2")

=======
  twoFactorAuthenticationSecret String
  isTwoFactorAuthenticationEnabled Boolean @default(false)

  status  Status @default(ONLINE)

>>>>>>> origin/game_dashboard
  stats   Stats?
  invited Friendships[] @relation("invited")
  invitor Friendships[] @relation("invitor")

  initiator DirectMessaging[] @relation("initiator")
  receiver DirectMessaging[] @relation("receiver")
<<<<<<< HEAD
  blocker DirectMessaging[] @relation("blocker")
=======
>>>>>>> origin/game_dashboard

  channels ChannelMembership[]
  messages Message[]

  notifyer Notification[] @relation("notifyer")
  notifyed Notification[] @relation("notifyed")

<<<<<<< HEAD
}


model match {
  id String @id @default(uuid())

  player_1    User   @relation("Player1", fields: [player_1_id], references: [id])
  player_1_id String 

  player_2    User   @relation("Player2", fields: [player_2_id], references: [id])
  player_2_id String
  result      String
  createdAt  DateTime @default(now())
=======
  Player1Games Game[] @relation("Player1")
  Player2Games Game[] @relation("Player2")

}

enum GameStatus {
  PENDING
  IN_PROGRESS
  FINISHED
}

model Game {
  game_id String @id @default(uuid())

  player1_id String
  player1 User @relation("Player1", fields: [player1_id], references: [id])

  player2_id String
  player2 User @relation("Player2", fields: [player2_id], references: [id])

  player1_score Int @default(0)
  player2_score Int @default(0)
  status GameStatus @default(PENDING)
  created_At DateTime @default(now())

>>>>>>> origin/game_dashboard
}


model Stats {
  id      String @id @default(uuid())
  user    User   @relation(fields: [user_id], references: [id])
  user_id String @unique

  wins         Int @default(0)
  losses       Int @default(0)
  ladder_level Int @default(0)
}


enum RelationStatus {
<<<<<<< HEAD
=======
  PENDING
>>>>>>> origin/game_dashboard
  FRIENDS
  BLOCK
}

model Friendships {
  id      String @id @default(uuid())
  user1    User   @relation("invited", fields: [user1_id], references: [id])
<<<<<<< HEAD
  user1_id String @unique

  user2    User   @relation("invitor", fields: [user2_id], references: [id])
  user2_id String @unique

  createdAt  DateTime @default(now())
  relationStatus RelationStatus  @default(FRIENDS)
=======
  user1_id String 

    user2    User   @relation("invitor", fields: [user2_id], references: [id])
    user2_id String 

    createdAt  DateTime @default(now())
    relationStatus RelationStatus  @default(PENDING)
>>>>>>> origin/game_dashboard
}


enum Role {
  OWNER
  ADMIN
  USER
}

model ChannelMembership {
  id String @id @default(uuid())

  channel    Channel @relation(fields: [channel_id], references: [id])
  channel_id String  

  user    User   @relation(fields: [user_id], references: [id])
  user_id String 

  role      Role
  joined_at DateTime @default(now())

<<<<<<< HEAD
  last_visit DateTime @default(now())
  
  is_banned Boolean? @default(false)
  ban_expires_at     DateTime?

  is_muted Boolean? @default(false)
  mute_expires_at   DateTime?

  createdAt DateTime? @default(now())
  @@unique([channel_id, user_id])
}


=======
  is_banned Boolean @default(false)
  banned_at DateTime?

  @@unique([channel_id, user_id])
}

>>>>>>> origin/game_dashboard
model Message {
  id String @id @default(uuid())

  user    User   @relation(fields: [user_id], references: [id])
  user_id String 

  channel    Channel?  @relation(fields: [channel_id], references: [id])
  channel_id String?   

  dm         DirectMessaging?  @relation(fields: [dm_id], references: [id])
  dm_id      String?   

  content    String
  createdAt DateTime? @default(now())
  is_read    Boolean ? @default(false)
}

enum Channel_type {
  PUBLIC
  PRIVATE
  PROTECTED
}

model Channel {
<<<<<<< HEAD
  id String @id @default(uuid()) 

  type         Channel_type
  name         String
  image        String 
=======
  id String @id @default(uuid())

  type         Channel_type
  name         String
  image        String //(2)this attribiute is for storing image location in filesystem also check (1)
>>>>>>> origin/game_dashboard
  memeberShips ChannelMembership[]
  messages     Message[]
  password     String?
  createdAt DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

enum DmStatus {
  ALLOWED
  BANNED
}

model DirectMessaging {
  id String @id @default(uuid())

  
  user1     User   @relation("initiator", fields: [user1_id], references: [id])
  user1_id  String

  user2     User   @relation("receiver", fields: [user2_id], references: [id])
  user2_id  String

  messages  Message[]

<<<<<<< HEAD
  status     DmStatus @default(ALLOWED)

  blocker     User?   @relation("blocker", fields: [blocker_id], references: [id])
  blocker_id  String? 

  createdAt  DateTime @default(now())
=======
  status    DmStatus @default(ALLOWED)
  createdAt DateTime @default(now())
>>>>>>> origin/game_dashboard
  updatedAt  DateTime @updatedAt
}


enum NotificationType {
<<<<<<< HEAD
  FRIENDSHIP_REQUEST
  ACCEPTED_INVITATION_REQUEST
=======
  ACCEPTED_INVITATION
  FRIENDSHIP_REQUEST
>>>>>>> origin/game_dashboard
}

model Notification {
  id String @id @default(uuid())

<<<<<<< HEAD
  user1     User   @relation("notifyed", fields: [user1_id], references: [id])
  user1_id  String 

  user2     User   @relation("notifyer", fields: [user2_id], references: [id])
  user2_id  String

=======
  user1     User   @relation("notifyer", fields: [user1_id], references: [id])
  user1_id  String 

  user2     User   @relation("notifyed", fields: [user2_id], references: [id])
  user2_id  String

  //I still don't know how the source notification will be like
>>>>>>> origin/game_dashboard
  type       NotificationType
  createdAt DateTime         @default(now())
}